#Author: ichivite@esri.com

import os, arcpy
path = r"\\boson\TestFiles\SD"                                      #Path to folder containing Service Definitions
serverConnection = r"D:\tests\ismael.ags"                           #ArcGIS Server connection file

#TODO: Process all foldeers within input directory 
#TODO: Start as many threads as PublishingTools GP Service instane are set to max

dirList=os.listdir(path)
print "This script publishes all Service Definitions at " + path + " into " + serverConnection

for fname in dirList:
    if '.sd' in fname:
        print " Publishing " + fname
        try:
            arcpy.UploadServiceDefinition_server(path + '/' + fname, serverConnection)
        except Exception, err:
            print "    ... publishing failed."

s = input ("Done!")
